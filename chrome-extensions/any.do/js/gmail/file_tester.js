var task_extractor=require("./task_extractor.js"),fs=require("fs");
function process_line(c){var a={};fields=c.split("\t");name=fields[1];if("null"===name||""===name)name=fields[0].replace(/@\S+$/,"").replace("."," ");a.sender={email:fields[0],name:name};a.subject=fields[2];a.body=fields[3];tasks=task_extractor.extract_tasks(a);if(0<tasks.length){output.write(a.sender.email+"\n");output.write(a.subject+"\n");output.write(a.body+"\n");console.log("---------");console.log(a.sender);console.log("subject:"+a.subject);console.log("body:"+a.body.substring(0,100));for(t in tasks)console.log("Task:"+
tasks[t][0]),output.write("Sentence:"+tasks[t][1]+"\n"),output.write("Task:"+tasks[t][0]+"\n"),output.write("\n");console.log("---------\n")}}function readLines(c,a){var b="";c.on("data",function(d){b+=d;for(d=b.indexOf("\n");-1<d;){var c=b.substring(0,d);b=b.substring(d+1);a(c);d=b.indexOf("\n")}});c.on("end",function(){0<b.length&&a(b)})}var output=fs.createWriteStream("c:anydo\\tmp\\enron_out2.txt"),input=fs.createReadStream("c:anydo\\tmp\\enron.txt");readLines(input,process_line);